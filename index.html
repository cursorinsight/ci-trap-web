<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Home - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Trap.html">Trap</a><ul class='methods'><li data-type='method'><a href="Trap.html#addCustomMetadata">addCustomMetadata</a></li><li data-type='method'><a href="Trap.html#apiKey">apiKey</a></li><li data-type='method'><a href="Trap.html#apiKeyName">apiKeyName</a></li><li data-type='method'><a href="Trap.html#apiKeyValue">apiKeyValue</a></li><li data-type='method'><a href="Trap.html#bufferSizeLimit">bufferSizeLimit</a></li><li data-type='method'><a href="Trap.html#bufferTimeout">bufferTimeout</a></li><li data-type='method'><a href="Trap.html#collectedEventCount">collectedEventCount</a></li><li data-type='method'><a href="Trap.html#collectedEvents">collectedEvents</a></li><li data-type='method'><a href="Trap.html#customMetadata">customMetadata</a></li><li data-type='method'><a href="Trap.html#enableCompression">enableCompression</a></li><li data-type='method'><a href="Trap.html#flushCollectedEvents">flushCollectedEvents</a></li><li data-type='method'><a href="Trap.html#generateNewStreamId">generateNewStreamId</a></li><li data-type='method'><a href="Trap.html#idleTimeout">idleTimeout</a></li><li data-type='method'><a href="Trap.html#log">log</a></li><li data-type='method'><a href="Trap.html#metadata">metadata</a></li><li data-type='method'><a href="Trap.html#mount">mount</a></li><li data-type='method'><a href="Trap.html#onDataSubmitted">onDataSubmitted</a></li><li data-type='method'><a href="Trap.html#removeCustomMetadata">removeCustomMetadata</a></li><li data-type='method'><a href="Trap.html#send">send</a></li><li data-type='method'><a href="Trap.html#sessionId">sessionId</a></li><li data-type='method'><a href="Trap.html#setCaptureCoalescedEvents">setCaptureCoalescedEvents</a></li><li data-type='method'><a href="Trap.html#setCaptureRequestAnimationFrame">setCaptureRequestAnimationFrame</a></li><li data-type='method'><a href="Trap.html#setCollectEvents">setCollectEvents</a></li><li data-type='method'><a href="Trap.html#setEventCollectionSizeLimit">setEventCollectionSizeLimit</a></li><li data-type='method'><a href="Trap.html#setLogDestination">setLogDestination</a></li><li data-type='method'><a href="Trap.html#setMetadataCollectUrls">setMetadataCollectUrls</a></li><li data-type='method'><a href="Trap.html#setMetadataSubmissionInterval">setMetadataSubmissionInterval</a></li><li data-type='method'><a href="Trap.html#setTransportMethod">setTransportMethod</a></li><li data-type='method'><a href="Trap.html#setUseWsTransport">setUseWsTransport</a></li><li data-type='method'><a href="Trap.html#start">start</a></li><li data-type='method'><a href="Trap.html#stop">stop</a></li><li data-type='method'><a href="Trap.html#stopDataCollectionOnPageHide">stopDataCollectionOnPageHide</a></li><li data-type='method'><a href="Trap.html#streamId">streamId</a></li><li data-type='method'><a href="Trap.html#submit">submit</a></li><li data-type='method'><a href="Trap.html#submitMetadata">submitMetadata</a></li><li data-type='method'><a href="Trap.html#umount">umount</a></li><li data-type='method'><a href="Trap.html#url">url</a></li></ul></li><li></li></ul><h3>Global</h3><ul><li><a href="global.html#instance">instance</a></li></ul>
    
</nav>

<div id="main">
    

    



    


    <section class="package">
        <h3> </h3>		
    </section>









    



    <section class="readme usertext">
        <article><h1>ci-trap-web <a href="https://github.com/cursorinsight/ci-trap-web/actions?query=workflow%3Atest"><img src="https://github.com/cursorinsight/ci-trap-web/actions/workflows/test.yaml/badge.svg?branch=main" alt="test"></a></h1>
<p>Lightweight mouse movement tracker library for browsers.</p>
<h2>Quickstart</h2>
<p>In order to collect mouse, pointer, touch and various other browser events from
a website do the following in your ES6 or CommonJS compatible project:</p>
<p><strong>1. Install:</strong></p>
<pre class="prettyprint source lang-shell"><code>$ npm install ci-trap-web
</code></pre>
<p><strong>2. Import <code>trap</code> client using ES6 module syntax:</strong></p>
<pre class="prettyprint source lang-javascript"><code>import trap from 'ci-trap-web';
</code></pre>
<p><strong>... or using CommonJS syntax:</strong></p>
<pre class="prettyprint source lang-javascript"><code>const { trap } = require('ci-trap-web');
</code></pre>
<p><strong>3. Set up data collection server and start collecting events:</strong></p>
<pre class="prettyprint source lang-javascript"><code>trap.url('https://your.server.com');
trap.mount(document.body);
</code></pre>
<p><strong>4. Check for Trap submissions in your network communications, e.g. using your
browser's development tools.</strong></p>
<h2>Examples</h2>
<p>There are working examples in the <code>examples/</code> directory:</p>
<ul>
<li>
<p><strong>ES6</strong> (in <code>examples/es6/</code>) provides a fully configured ES6 compatible
example to start integrating Trap into a modern Javascript framework, e.g.
React.</p>
</li>
<li>
<p><strong>Vanilla</strong> (in <code>examples/vanilla/</code>) contains a precompiled Javascript
bundle and the necessary steps to integrate Trap into a bare-bone HTML
document -- without the need to set up a complex build framework.</p>
</li>
<li>
<p><strong>Sandbox</strong> (in <code>examples/sandbox/</code>) is our experimental sandbox to test
and validate new features, execute various research tasks, e.g., saving
collected chunks to files into a configurable directory.</p>
</li>
</ul>
<h2>Develop</h2>
<p>You may want to develop new features or reproduce bugs in a working
environment, for this we recommend using our &quot;Sandbox&quot; example in the
<code>examples/sandbox/</code> directory.</p>
<p>Examples are set up. They can be installed and started with these simple
commands:</p>
<ol>
<li>
<p>Install the root project's dependencies (in the project's root):</p>
<pre class="prettyprint source"><code>$ make install-deps
</code></pre>
</li>
<li>
<p>Go into the example you want to start -- e.g. &quot;Sandbox&quot; in this case -- and
install its dependencies:</p>
<pre class="prettyprint source"><code>$ cd examples/sandbox/
$ make install-deps
</code></pre>
</li>
<li>
<p>Start the web server to start the example application:</p>
<pre class="prettyprint source"><code>$ make server
</code></pre>
</li>
</ol>
<p>The UI of the example is available at http://localhost:3000/.</p>
<h2>Configuration</h2>
<p>You can configure <code>ci-trap-web</code> by specifying environment variables during build
time. These environment variables act as configuration parameters.</p>
<p>You can find the configuration parameters in <code>src/constants.js</code>. Each
configuration parameter has a <code>process.env.&lt;name&gt;</code> reference in <code>constants.js</code>.</p>
<p>See the <em>How to generate <code>gt.min.js</code></em> section for an example that overrides the
<code>APP_DEFAULT_TRAP_API_KEY_VALUE</code> configuration parameter.</p>
<h2>How to generate <code>gt.min.js</code></h2>
<ol>
<li>
<p>Install the root project's dependencies (in the project's root):</p>
<pre class="prettyprint source"><code>$ make install-deps
</code></pre>
</li>
<li>
<p>Generate a UUID that you will use as the API key (optional):</p>
<pre class="prettyprint source"><code>$ uuidgen
aa34677e-a3ee-445c-8483-a30924ebc5d9
</code></pre>
</li>
<li>
<p>Build a release (replace the API key):</p>
<pre class="prettyprint source"><code>$ APP_DEFAULT_TRAP_API_KEY_VALUE=aa34677e-a3ee-445c-8483-a30924ebc5d9 \
      make release
</code></pre>
</li>
<li>
<p>You can find your customized <code>gt.min.js</code> as <code>dist/gt.min.js</code>.</p>
</li>
</ol>
<h2>How to generate <code>gt.min.js</code> with Docker</h2>
<p>You can build assets in a dockerized environment, without the need to install
Node.js and its dependencies.</p>
<ol>
<li>
<p>Generate a UUID that you will use as the API key (optional):</p>
<pre class="prettyprint source"><code>$ uuidgen
aa34677e-a3ee-445c-8483-a30924ebc5d9
</code></pre>
</li>
<li>
<p>Build JavaScript asset files with the Docker environment provided:</p>
<pre class="prettyprint source"><code>$ docker build --ssh default --build-arg GIT_USER=${GIT_USER} . \
    -t ci-trap-web
</code></pre>
<p>Replace <code>${GIT_USER}</code> with your Gerrit/Git user.</p>
</li>
<li>
<p>Resulting assets are put into the container's <code>/opt/app/</code> directory which
can be easily accessed after starting the container and using <code>curl</code> or
directly copy the files out of it:</p>
<ul>
<li>
<p>Start the container:</p>
<pre class="prettyprint source"><code>$ docker run --rm -p 8080:80 --name ci-trap-web ci-trap-web
</code></pre>
</li>
<li>
<p>In a separate shell, use <code>curl</code> to fetch the asset:</p>
<pre class="prettyprint source"><code>$ curl -O http://your-docker-server:8080/gt.min.js
</code></pre>
</li>
<li>
<p>Or directly copy the file out of it:</p>
<pre class="prettyprint source"><code>$ docker cp ci-trap-web:/opt/app/gt.min.js ./gt.min.js
</code></pre>
</li>
</ul>
</li>
</ol>
<h2>License</h2>
<p><code>ci-trap-web</code> is released under the <a href="https://github.com/cursorinsight/ci-trap/blob/master/LICENSE">MIT license</a>.</p></article>
    </section>






    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Sun Jan 26 2025 22:20:30 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>